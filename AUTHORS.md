This code was initially authored by Ingo Jahn, but has since been passed to
Kieran Mackle.

